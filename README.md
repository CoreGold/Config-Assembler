# Ассемблер и интерпретатор для виртуальной машины
 
Этот репозиторий содержит ассемблер и интерпретатор для простой виртуальной машины (VM). Ассемблер переводит текстовый код в машинный, а интерпретатор выполняет машинный код и управляет виртуальной памятью.

## Возможности
Ассемблер - Конвертирует команды в машинный код.

Интерпретатор - Исполняет машинный код с использованием виртуальной памяти.

### Поддерживаемые команды: 
loadc a b: Загружает константу b в аккумулятор.

read a: Читает значение из памяти по адресу в аккумуляторе.

write a b: Записывает значение из аккумулятора в адрес памяти b.

bswap a: Меняет порядок байт в аккумуляторе.

## Использование

Для работы программы необходимы библиотека PyYaml и Python 11

### Ассемблер
```
python main.py assemble <input_file> <output_file> <log_file>
```
* <input_file>: Файл с командами на "ассемблере".
* <output_file>: Файл для сохранения машинного кода.
* <log_file>: Файл для сохранения лога операций в формате YAML.
### Интерпретатор
```
python main.py interpret <input_file> <output_file> <start_mem> <end_mem>
```
* <input_file>: Файл с машинным кодом.
* <output_file>: Файл для сохранения состояния памяти в формате YAML.
* <start_mem> и <end_mem>: Диапазон адресов памяти для вывода.

### Формат входных данных
```
('loadc', 0, 234)
('bswap', 0)
('write', 0, 10)
```

## Тестирование

Входной файл input.txt
```
('loadc', 55, 234)
('write', 61, 10)
('loadc', 55, 10)
('read', 57)
('bswap', 33)
('write', 61, 5)
```
Аргументы для ассемблера
```
python config4.py assemble input.txt output.bin log.yaml
```
Лог файл в формат yaml
```
log:
- loadc a=55 b=234
- write a=61 b=10
- loadc a=55 b=10
- read a=57
- bswap a=33
- write a=61 b=5
```

Аргументы для интерпретера
```
python config4.py interpret output.bin result.yaml 0 10
```

Результат работы интерпретера в формате yaml
```
memory:
  address_0: 0
  address_1: 0
  address_2: 0
  address_3: 0
  address_4: 0
  address_5: 3925868544
  address_6: 0
  address_7: 0
  address_8: 0
  address_9: 0
  address_10: 234
```
Готовые тесты каждой команды представлены в файле TestAssembler.py

# Тестовая программа

Программа получает на вход массив: 10 20 30 40 50 60 70 80, хранящийся в 1-8 ячейках памяти.
* Команды
```
('loadc', 55, 10)
('write', 61, 1)
('loadc', 55, 20)
('write', 61, 2)
('loadc', 55, 30)
('write', 61, 3)
('loadc', 55, 40)
('write', 61, 4)
('loadc', 55, 50)
('write', 61, 5)
('loadc', 55, 60)
('write', 61, 6)
('loadc', 55, 70)
('write', 61, 7)
('loadc', 55, 80)
('write', 61, 8)
```
* Результат
```
memory:
  address_0: 0
  address_1: 10
  address_2: 20
  address_3: 30
  address_4: 40
  address_5: 50
  address_6: 60
  address_7: 70
  address_8: 80
  address_9: 0
  address_10: 0
```

По завершению работы возвращается массив: 16777216 33554432 50331648 67108864 83886080 100663296 117440512 134217728 
